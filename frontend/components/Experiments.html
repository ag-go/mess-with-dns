<div id="experiments" class="px-8 md:w-1/2 lg:w-1/3 w-full  md:overflow-scroll " style="height: 80vh">
    <style type="text/css"></style>
    <!-- beaker svg -->
    <h1 class="font-bold  text-3xl text-left mb-4">
        <svg class="inline" width="50px" viewBox="0 0 128 128" xmlns="http://www.w3.org/2000/svg">
            <g>
                <path fill="none" fill-rule="nonzero" stroke="#000000" stroke-width="6" stroke-linecap="round" stroke-linejoin="round" marker-start="none" marker-mid="none" marker-end="none" stroke-miterlimit="4" stroke-dashoffset="0" id="rect3162" d="m43.035622,6.4153c6.53336,6.41494 5.54726,11.26442 5.618279,19.0292l0.224281,24.521339l-31.822762,47.669956c-7.70109,12.839386 -2.49131,25.401253 10.13991,24.659454l73.043257,0.073807c13.653183,-0.057426 18.638214,-12.708916 8.057533,-26.039894l-30.186295,-46.244804l-0.56813,-24.560598c-0.071014,-7.76478 -1.14566,-12.595409 5.269279,-19.12877l-39.775352,0.02031z" />
                <path fill="none" fill-rule="evenodd" stroke="#000000" stroke-width="6" stroke-linecap="round" stroke-miterlimit="4" id="path3180" d="m77.493759,25.174719l-10.905273,0" />
                <path fill="none" fill-rule="evenodd" stroke="#000000" stroke-width="6" stroke-linecap="round" stroke-miterlimit="4" d="m77.493759,44.409069l-10.905273,0" id="path3182" />
                <path fill="none" fill-rule="evenodd" stroke="#000000" stroke-width="6" stroke-linecap="round" stroke-miterlimit="4" id="path3184" d="m83.676224,64.330353l-10.905266,0" />
                <path fill="none" fill-rule="evenodd" stroke="#000000" stroke-width="6" stroke-linecap="round" stroke-miterlimit="4" d="m94.323807,79.786522l-10.905266,0" id="path3186" />
                <path fill="none" fill-rule="evenodd" stroke="#000000" stroke-width="6" stroke-linecap="round" stroke-miterlimit="4" id="path3188" d="m104.971397,95.242691l-10.905273,0" />
        </svg>
        Try an experiment!
    </h1>
    <hr class="my-4">
    <p>
        <span class="font-bold">Tutorial experiments:</span> These 4 experiments explain some DNS basics and how the site works
    </p>
    <details class="experiment">
        <summary>
            <h3>
                1. Create an A record
                <span class="category">
                    A records
                </span>
            </h3>
        </summary>
        <p>
            Let's create the most basic DNS record: an A record. For the IP address, we'll use an IP (213.188.218.160) I set up
            for this project which just shows a picture of an orange.
        </p>
        <ol>
            <li>Configure an A record for <domain-link :domain='domain' subdomain='orange'> </domain-link> pointing it to 213.188.218.160, like this:
                <img src="/images/orange-a.png">
                Set the TTL to 60 seconds (TTLs are always in seconds on this page).
            </li>
            <li> Click "Create" </li>
            <li>
                Go to <domain-link :domain='domain' subdomain='orange'> </domain-link> in your browser
            </li>
            <li> You should see a website with a picture of an orange! </li>
        </ol>
    </details>
    <details class="experiment">
        <summary>
            <h3>
                2. Create a CNAME record
                <span class="category">
                    CNAME records
                </span>
            </h3>
        </summary>
        <p>
            Now, let's create a CNAME record that points at exact the same orange IP address, but indirectly.
        </p>
        <ol>
            <li>Configure an CNAME record for <domain-link :domain='domain' subdomain='fruit'> </domain-link> that points at <code>orange.messwithdns.com</code>, like this:
                <img src="/images/orange-cname.png">
                <p class="mt-2">
                Set the TTL to 60 seconds (TTLs are always in seconds on this page). Here's a screenshot:
                </p>
            </li>
            <li> Click "Create" </li>
            <li>
                Go to <domain-link :domain='domain' subdomain='fruit'> </domain-link> in your browser.
            </li>
            <li> You should see a website with a picture of an orange! </li>
        </ol>
    </details>
    <details class="experiment">
        <summary>
            <h3>
                3. Look at a DNS request/response
                <span class="category">
                    requests
                </span>
            </h3>
        </summary>
        <p>
            The "Requests" section at the bottom of this page lets you see all
            DNS requests being made for subdomains of <code
                class="text-green-700">{{ domain}}.messwithdns.com</code>!
            Let's look at an example, so you can see how it works.
        </p>
        <ol>
            <li>Configure an CNAME record for <domain-link :domain='domain' subdomain='purple'> </domain-link> that points at <code>purple.messwithdns.com</code>, like this:
                <img src="/images/tut-request.png">
            </li>
            <li> Click "Create" </li>
            <li>
                Go to <domain-link :domain='domain' subdomain='purple'> </domain-link> in your browser
            </li>
            <li>Look in the "Requests" section at the bottom of the page. You should see a request for
                <domain-link :domain='domain' subdomain='purple'> </domain-link>.
            </li>
            <li> 
                Look at the "Request source" on the request. Do you recognize
                it? It might be your ISP, or a public DNS resolver like
                Cloudflare or Google 
            </li>
        </ol>
    </details>
    <hr class="my-4">
    <p>
        <span class="font-bold">Weird experiments:</span> In these 5 experiments, we break things for fun and learning!
    </p>
    <details class="experiment">
        <summary>
            <h3>
                1. Visit a domain before creating its record
                <span class="category">
                    caching
                </span>
            </h3>
        </summary>

        <p class="my-4">
            If you visit a domain before setting your DNS records for
            that domain, it still won't work for some time after
            setting the record!
            Here's an experiment you can do to see
            that happen yourself:
        </p>
        <ol>
            <li>
                Go to <domain-link subdomain="visit-before" :domain='domain'> </domain-link>
                in your browser. You should get an error like "Server Not Found".
            </li>
            <li>
                Create a CNAME record pointing <domain-link subdomain="visit-before" :domain='domain'> </domain-link>
                at <code>orange.messwithdns.com</code>, like this:
                <img src="/images/cname-screenshot.png" class="block border  border-dashed border-green-700 mb-4 mt-2">
            </li>
            <li>
                Go to <domain-link subdomain="visit-before" :domain='domain'> </domain-link> in your browser again. You should get the same "Server Not Found" error as before.
            </li>
            <li>
                Repeat this with a different subdomain (
                <domain-link subdomain="visit-after" :domain='domain'> </domain-link>)
                ,
                but <span class="font-bold">don't</span> visit the
                domain first. This should show your a website with
                an orange.
            </li>
        </ol>

        <p class="my-4">
        <details>
            <summary>
                <span class="text-green-700">
                    (click here to see the explanation)
                </span>
            </summary>
            <p>
                This is because of something called "negative DNS caching" -- DNS servers will cache the <strong>absence</strong> of a record.
            </p>
        </details>
        </p>
    </details>

    <details class="experiment">
        <summary>
            <h3>
                2. Set a very long TTL
                <span class="category">
                    caching
                </span>
            </h3>
        </summary>
        <p>
        Setting a very long TTL (like 10 days) makes your life very
        inconvenient: if you want to make a change, you need to wait up to 10
        days for the change to happen! Let's try setting a 10-day TTL on a
        record.
        </p>
        <p>
 First, let's see how things normally work with a short (30 second) TTL 
        </p>
        <ol>
            <li>
                Create a CNAME record pointing <domain-link subdomain="short-ttl" :domain='domain'> </domain-link>
                at <code>orange.messwithdns.com</code>. Set the TTL to 30 seconds.

                <img src="/images/short-ttl.png">
            </li>
            <li>
                Go to <domain-link subdomain="long-ttl" :domain='domain'> </domain-link>
                in your browser. You should see an orange website.
            </li>
            <li>
                Click 'Edit' and change the CNAME record to point at <code>purple.messwithdns.com</code> instead.
                <img src="/images/short-purple-ttl.png">
            </li>
            <li>
                <p>
                Go to <domain-link subdomain="long-ttl" :domain='domain'> </domain-link>
                in your browser again. You might need to force-refresh with
                Ctrl+Shift-R/Cmd+Shift+R, but you should see a purple site now.
                The update worked!
                </p>
                <p>
                Now, let's see what happens if you set a long TTL.
                </p>
            </li>
            <li>
                Create a CNAME record pointing <domain-link subdomain="long-ttl" :domain='domain'> </domain-link>
                at <code>orange.messwithdns.com</code>.

                Use a long TTL like 3000000 seconds (that's 30 days!).
                <img src="/images/long-ttl.png">
            </li>
            <li>
                Go to <domain-link subdomain="long-ttl" :domain='domain'> </domain-link>
                in your browser. You should see an orange website.
            </li>
            <li>
                Click 'Edit' and change the CNAME record to point at <code>purple.messwithdns.com</code> instead.
                <img src="/images/long-purple-ttl.png">
            </li>
            <li>
                Go to <domain-link subdomain="long-ttl" :domain='domain'> </domain-link>
                in your browser again. You should see
                the same orange site -- no change!
                This is because your old DNS record is
                still cached.
                You might also notice that there are no new requests in the "Requests" section.
            </li>
        </ol>

        <p class="my-4">
        <details>
            <summary>
                <span class="text-green-700">
                    (click here to see the explanation)
                </span>
            </summary>
            <p>
                TODO: add explanation
            </p>
        </details>
        </p>
    </details>

    <details class="experiment">
        <summary>
            <h3>
                3. Point to <code>example.com</code>
                <span class="category">
                    A records
                </span>
            </h3>
        </summary>
        <ol>
            <li> Find the IP address for <code>example.com</code>. You can do this by running <code> dig example.com</code> in your terminal. Or you can just pretend you did it, the IP is <code>93.184.216.34</code> :). </li>
            <li> Set an A record pointing <domain-link :domain='domain' subdomain='bad-ip'> </domain-link> at that IP (<code>93.184.216.34</code>). You can use any TTL you want. </li>
            <li> Go to <domain-link :domain='domain' subdomain='bad-ip'> </domain-link> in your browser. You should get a 404 not found error. </li>
        </ol>
        <details class="my-4">
            <summary>
                <span class="text-green-700">
                    (click here to see the explanation)
                </span>
            </summary>
            <p>
                TODO
            </p>
        </details>
    </details>
    <details class="experiment">
        <summary>
            <h3>
                4. Convince 3 different DNS servers that your subdomain has 3 different IPs (3-ips)
                <span class="category">
                    caching
                </span>
            </h3>
        </summary>

        <p class="my-4">
            Let's create some confusion and chaos! This is usually a bad thing, but let's do it on purpose so that you can see how it could happen accidentally.
        </p>
        <p class="my-4">
            Your goal is to convince:
        </p>
        <ol style="list-style-type: disc;" class="pl-8">
            <li>
                Google's DNS server that your subdomain has one IP (10.11.12.13),
            </li>
            <li>
                Cloudflare's DNS server that your subdomain has another IP (20.21.22.23)
            </li>
            <li>
                Quad9's DNS server that your subdomain has a third IP (30.31.32.33)
            </li>
        </ol>

        <p class="my-4">
            Let's start!
        </p>
        <ol>
            <li>
                Create an A record pointing <domain-link subdomain="3-ips" :domain='domain'> </domain-link>
                at <code>10.11.12.13</code>. Use a long TTL like 3600 seconds.
                <img src="/images/cname-screenshot-5.png" class="block border border-dashed border-green-700 mb-4 mt-2">
            </li>
            <li>
                In your terminal, run
                <pre>$ dig @8.8.8.8 3-ips.{{domain}}.messwithdns.com</pre>
                Run it 10 times just to be safe. Google has many DNS servers, so we want to hit most of them.
            </li>
            <li>
                Change the A record to point at <code>20.21.22.23</code> instead. Keep the TTL the same.
            </li>
            <li>
                Time to tell Cloudflare about the domain! In your terminal, run
                <pre>$ dig @1.1.1.1 3-ips.{{domain}}.messwithdns.com</pre>
                Run it a few times.
            </li>
            <li>
                Last change!
                Change the A record to point at <code>30.31.32.33</code> instead. Keep the TTL the same.
            </li>
            <li>
                Now we'll tell Quad9 about the domain. In your terminal, run
                <pre>$ dig @9.9.9.9 3-ips.{{domain}}.messwithdns.com</pre>
            </li>
            <li>
                Now, let's ask all 3 providers what they think our IP address is. Here's what I see:

                <pre>
$ dig @8.8.8.8 3-ips.{{domain}}.messwithdns.com
bad-ip.ionized-twig.messwithdns.com. 30	IN A	10.11.12.13
$ dig @1.1.1.1 3-ips.{{domain}}.messwithdns.com
bad-ip.ionized-twig.messwithdns.com. 30	IN A	20.21.22.23
$ dig @9.9.9.9 3-ips.{{domain}}.messwithdns.com
bad-ip.ionized-twig.messwithdns.com. 30	IN A	30.31.32.33
</pre>
                All of the 3 DNS servers have different opinion about what our IP address is! Mischief managed.

            </li>
        </ol>
        <p class="my-4">
        <details>
            <summary>
                <span class="text-green-700">
                    (click here to see the explanation)
                </span>
            </summary>
            <p>
                TODO
            </p>
        </details>
        </p>
    </details>

    <details class="experiment">
        <summary>
            <h3>
                5. Set two conflicting A records
                <span class="category">
                    A records
                </span>
            </h3>
        </summary>

        What if you set two A records on a domain that refer to totally different sites? Let's find out!
        <ol>
            <li> Set an A record pointing <domain-link subdomain="conflict" :domain='domain'> </domain-link> at
                213.188.218.160 with a TTL of 5 seconds.
            </li>
            <li> Set another A record pointing <domain-link subdomain="conflict" :domain='domain'> </domain-link> at
                213.188.209.192 with a TTL of 5 seconds.
            </li>
            <li>
                In your terminal, run
                <pre>$ curl http://conflict.{{currDomain()}}.messwithdns.com 2&gt;/dev/null | grep title </pre>
                10 times.
                The result you get should change back and forth between 'orange' and 'purple', like this:
                <pre>
$ curl http://conflict.{{currDomain()}}.messwithdns.com/ 2&gt; /dev/null | grep title
&lt;title&gt;orange&lt;/title&gt;
$ curl http://conflict.{{currDomain()}}.messwithdns.com/ 2&gt; /dev/null | grep title
&lt;title&gt;purple&lt;/title&gt;
$ curl http://conflict.{{currDomain()}}.messwithdns.com/ 2&gt; /dev/null | grep title
&lt;title&gt;orange&lt;/title&gt;
$ curl http://conflict.{{currDomain()}}.messwithdns.com/ 2&gt; /dev/null | grep title
&lt;title&gt;purple&lt;/title&gt;
$ curl http://conflict.{{currDomain()}}.messwithdns.com/ 2&gt; /dev/null | grep title
&lt;title&gt;orange&lt;/title&gt;
$ curl http://conflict.{{currDomain()}}.messwithdns.com/ 2&gt; /dev/null | grep title
&lt;title&gt;purple&lt;/title&gt;
$ curl http://conflict.{{currDomain()}}.messwithdns.com/ 2&gt; /dev/null | grep title
&lt;title&gt;orange&lt;/title&gt;
$ curl http://conflict.{{currDomain()}}.messwithdns.com/ 2&gt; /dev/null | grep title
&lt;title&gt;purple&lt;/title&gt;
</pre>
            </li>
            </ul>
            It can't make up its mind what website it is!
            <p class="my-4">
            <details>
                <summary>
                    <span class="text-green-700">
                        (click here to see the explanation)
                    </span>
                </summary>
                <p>
                    TODO curl is doing like round robin dns blah blah, it's not random,
                    this is actually used and it's called dns load balancing (obv not with totally different websites)
                    don't do this as a hack for a/b testing lol
                </p>
            </details>
            </p>
    </details>


    <hr class="my-4">
    <p>
        <span class="font-bold">Useful experiments</span>: The rest of the experiments are things that you actually might want to do in real life.
    </p>
    <details class="experiment">
        <summary>
            <h3>
                1. Query the source of truth
                <span class="category">
                    authoritative nameserver
                </span>
            </h3>
        </summary>

        <p>
            In the previous experiments, we were looking at how
            DNS names are cached. But you can always query the
            source of truth for a domain: the <strong> authoritative nameserver </strong>.
        </p>


        <p>
        <ol>
            <li>

                Create an A record for <domain-link :domain='domain'> </domain-link> at <code>example.com</code>, like this:
                <img src="/images/cname-screenshot.png" class="block border  border-dashed border-green-700 mb-4 mt-2">
            </li>
            <li>
                In your terminal, run
                <pre>$ dig +trace {{currDomain()}}.messwithdns.com</pre> to get the authoritative nameserver. The answer should be
                <pre>ns1.messwithdns.com.</pre>
            </li>
            <li>
                Run:
                <pre>$ dig @ns1.messwithdns.com {{currDomain()}}.messwithdns.com</pre>
                to get the A record for your domain

            </li>
            <li>
                Make some changes to your A record, run
                <pre> dig @ns1.messwithdns.com {{currDomain()}}.messwithdns.com </pre> again, and notice the changes are always immediately reflected even if there's a very big TTL!
            </li>
        </ol>
        </p>
    </details>
    <details class="experiment">
        <summary>
            <h3>
                2. Get a Let's Encrypt certificate
                <span class="category">
                    TXT records
                </span>
            </h3>
        </summary>
    </details>

    <details class="experiment">
        <summary>
            <h3>
                3. Receive an email
                <span class="category">
                    MX records
                </span>
            </h3>
        </summary>
        <ol>
            <li>
                Go to Fastmail and sign up for an email account using the address yourname@{{currDomain()}}.messwithdns.com
                (they have a 30-day free trial). The setup option you use don't matter too much.
            </li>
            <li>
                Add an MX record for <domain-link :domain='domain'> </domain-link> pointing it to <code>ns1.messagingengine.com </code> with preference 10
            </li>
            <li>
                Add another MX record for <domain-link :domain='domain'> </domain-link> pointing it to <code>ns2.messagingengine.com </code> with preference 20
            </li>
            <li>
                Check with Fastmail that your MX records are working. There's a button in the settings
            </li>
        </ol>
    </details>
    <details class="experiment">
        <summary>
            <h3>
                4. Set up Netlify or GitHub Pages
                <span class="category">
                    CNAME records
                </span>
            </h3>
        </summary>
    </details>
    <details class="experiment">
        <summary>
            <h3>
                5. Send an email (and pass the SPF check)
                <span class="category">
                    TXT records (SPF)
                </span>
            </h3>
        </summary>
    </details>
</div>
